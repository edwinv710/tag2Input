var TaggableInput=function(){var a="taggable-input",b="label",c=[" "],d={beforeInsert:function(a,b){return a},afterInsert:function(a,b,c){}},e=function(a,b,c,d){var e=d.value.split(c);0===e[e.length-1].length&&e.pop(),a.add(e),d.value=""},f=function(a,b){var c=a.delimiter.join("|"),d=new RegExp(c);return function(c){d.test(this.value)&&e(a,b,d,this),b.innerText=this.value,this.style.width=b.clientWidth+(this.offsetWidth-this.clientWidth+5)+"px"}},g=function(b,c){if("string"==typeof b&&(b=document.getElementById(b)),!(b instanceof HTMLElement))throw"Please provide a valid container.";return b.className=" "+a,b.onclick=function(a){a.target===this&&c.focus()},b},h=function(){var a=document.createElement("span"),b={position:"absolute",display:"inline-block",height:"0px",left:"0",top:"0",overflow:"hidden"};a.className="hiddenSpan";for(var c in b)a.style[c]=b[c];return a},i=function(a,b){var c=document.createElement("input");return c.setAttribute("type","text"),c.setAttribute("size","1"),c.addEventListener("input",f(a,b),!0),c.addEventListener("paste",f(a,b),!0),c.addEventListener("keyup",function(b){8==b.which&&0==this.value.length&&a.pop()}),c},j=function(a,b,c){a.appendChild(c),a.appendChild(b)},k=function(a){return function(b){var c=document.getElementById(b.dataTransfer.getData("item")),d=b.target.parentNode,e=a?d:d.nextSibling;return d.parentNode.insertBefore(c,e),b.stopPropagation(),!1}},l=function(a,b){var c=document.createElement("div"),d=document.createElement("span"),e=document.createElement("span"),f=document.createElement("span");return c.className="label close",c.id="label-"+Math.random().toString(36).substr(2,18).toUpperCase(),e.innerText=b,e.className="content",a.editable&&(e.setAttribute("contenteditable",!0),e.addEventListener("keydown",function(a){8===a.which&&1===this.innerHTML.length&&this.parentNode.parentNode.removeChild(this.parentNode)}),["keyup","mouseup","cut"].map(function(a){e.addEventListener(a,function(a){0==this.innerHTML.length&&this.parentNode.parentNode.removeChild(this.parentNode)})})),a.removable&&(c.className+=" close",f.addEventListener("click",function(a){this.parentNode.parentNode.removeChild(this.parentNode)})),d.className="drop-left",d.innerHTML="&nbsp;",f.innerHTML="&nbsp;",f.className="drop-right",c.appendChild(d),c.appendChild(e),c.appendChild(f),a.draggable&&(c.setAttribute("draggable","true"),d.addEventListener("dragenter",function(a){return a.preventDefault(),!0}),f.addEventListener("dragenter",function(a){return a.preventDefault(),!0}),d.addEventListener("dragover",function(a){return a.preventDefault(),!0}),f.addEventListener("dragover",function(a){return a.preventDefault(),!0}),d.addEventListener("drop",k(!0)),f.addEventListener("drop",k(!1)),c.addEventListener("dragstart",function(a){return a.dataTransfer.setData("item",this.id),!0})),c},m=function(a,b){var e=h();this.delimiter=b.delimiter||c,this.delimiter=this.delimiter instanceof Array?this.delimiter:[this.delimiter],this.delimiter=this.delimiter.map(function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}),this.editable=0!=b.editable,this.draggable=0!=b.draggable,this.removable=0!=b.removable,this.input=i(this,e),this.container=g(a,this.input);for(var f in d)this[f]=b[f]||d[f];j(this.container,this.input,e)};return m.prototype={add:function(a){a=a instanceof Array?a:[a];for(var b=0;b<a.length;b++)a[b]=this.beforeInsert(a[b]),a[b]=l(this,a[b]),this.container.insertBefore(a[b],this.input),this.afterInsert(a[b])},remove:function(a){return"number"==typeof a&&(a=this.tags(a)),a.parentNode.removeChild(a),a},pop:function(){var a=this.remove(-1);return a},tags:function(a){var c=this.container.getElementsByClassName(b);return a?(a=(c.length+a)%c.length,c[a]):c},values:function(){var a=this.container.getElementsByClassName("label");return[].map.call(a,function(a){return a.innerText})}},m}();